# CSRF

<code style="color : darkOrange">What is Cross Site Request Forgery? Explain the root cause, impact and remediation.</code>

CSRF vulnerability arises because of the fact that an application does not have any mechanism to know whether the request that is coming from the user is actually intended by the user. The attacker might be able to trick the user to perfom some state chaning operation on behalf of them.

<code style="color : aquamarine">Impact:</code>

The attacker can perform any state changing operation post authentication like password change or amount tranfering

<code style="color : aquamarine">Remediations:</code>

1. Implement csrf token
2. in very cruecial operations implement 2FA
<!--  -->

<code style="color : darkOrange">Explain CSRF token mechanism.</code>

When user logins into the application a csrf token is generated in the server-side and sent to the browser when the pages loads. Now, when the user makes some state-changing request the csrf token is sent along with the request,then this token will be validated in the server against the token which is there in the server and if it matches then the operation is allowd, otherwise not.

<!--  -->

<code style="color : darkOrange">If CSRF token is put in cookie, is it ok?</code>

No, it is not okay becasue the whole purpose of csrf token will be null and void as cookie is automatically adde to every request.

<!--  -->

<code style="color : darkOrange">If the application has CSRF token, what are the test cases you will perform to verify it's properly implemented?</code>

1. Remove the csrf token paremeter.
2. keep csrf token empty.
3. use null byte in the csrf token.
4. reuse another user's csrf token.
5. add any random csrf token
<!--  -->

<code style="color : darkOrange">What is the cookie security attribute for CSRF? Explain it's significance.</code>

SameSite.

Enabling the sameSite attibute prevents adding cookies to cross-site requests.

it has three values.

1. Strict: It does not allow the browser to add cookies to any cross-site requests

2. lax: It allows the browser to add cookies in cross-site requests which have safer http verbs like GET/HEAD

3. None: It basically means SameSite is not enabled

<code style="color : yellowgreen">
Limitation: sameSITE attribute is a relatively new browser side control of mitigating CSRF. Legacy browser versions do not acknowledge the attribute, hence if a victim user is using older browser version, sameSITE cookie attribute will not beentertained by the browser and cookies will be added to cross origin request,and CSRF will happen.
</code>

<!--  -->

<code style="color : darkOrange">The target application has custom fixed header value set for CSRF prevention. Is it fullproof?</code>

No, the attacker can bypass it in modern application which has AJAX by using XMLhttp request.
