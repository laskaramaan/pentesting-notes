# Injection

<code style="color : darkOrange">What is Injection attack? Explain with remediation.</code>

Injection attack is one of the top OWASP attacks where the attacker's supplied malicious payload gets executed by the underlying system as a code instead of considering it a data.

The generic remediation is to perform whitelist input validation and sanitisation.Depending on what type of injection it is there can be more specific remediations as well.

<!--  -->

<code style="color : darkOrange">What is SQL Injection? Explain the root cause, impact and remediation.</code>

SQL injection is an attack where attacker supplied malicious SQL payload gets executed by the underlying SQL database engine which can cause harm.

<code style="color : aquamarine">Impact:</code>

The Attacker mught be able to perform CRUD operations to the data in the database or infact temper the database schema itself.

<code style="color : aquamarine">Rootcause:</code>

The rootcause of this vulnerability is the fact that the application construct dynamic SQL querires using the user-given input

<code style="color : aquamarine">Remediations:</code>

1. Perform whitelist input validation and sanitisation
2. Always use parameterised SQL queries

<!--  -->

<code style="color : darkOrange">What is NoSQL Injection? Explain the root cause, impact and remediation.</code>

NoSQL injection is similar to SQL injecton, only the difference is that here the target database is a noSQL database for e.g. (mongoDb, CouchDB, and Redis)

<code style="color : aquamarine">Example payload:</code>

```
{"$or":[{"username":"admin"},{"$gt":[]}]}
```

This payload takes advantage of a vulnerability in the login form of a web application that does not properly sanitize user input. The payload injects an `$or` operator into the MongoDB query that selects all documents from the `users` collection where the `username` field is either "admin" or greater than an empty array (`[]`). Since an empty array is always less than any other value, this effectively selects all documents from the `users` collection.

<!--  -->

<code style="color : darkOrange">What are the various types of SQLi?</code>

Broadly there are three types of SQLi.

1.  <code style="color : aquamarine">Error-based SQLi:</code>

    In this type of SQLi the Attacker's actions forces the application to throw some error which can reveal some-sentive inforation related to the database.

2.  <code style="color : aquamarine"> Blind SQli:</code>

    a. **Time-based SQLi:** Here the payload consists of Delay/sleep clause. Now, if the injection attack is successful then the response would come after that much of delay which is mentioned in the payload.

    e.g.: sleep(5)

    b. **Boolean-based SQLi:** Here the payload consists of true/false condition. If the attack is successful then the response would vary depending on the condition.

    e.g.: 1=1,1=2

3.  <code style="color : aquamarine">UNION based SQLi:</code>

    Attacker can retrieve sensitive data from database by using the UNION SQL operator based payloads.

    **Pre-requisites:**

    1.The malicious query returns the same number of columns as the original query

    2.The data types on all columns should be compatible with each SQL query

 <!--  -->

<code style="color : darkOrange">What is second order SQLi?</code>

In second order SQli the malicious payload does not comes directly from the attcker as a http request. Here the source of input maybe a result of another query to some other internal database engine or storage system.

<code style="color : aquamarine">Attack scenerio:</code>

Attack scenario:

- Application uses parameterised SQL query for all places where input comes from HTTP request i.e. end users (1st order SQLi got prevented).
- Imagine such a parameterised insert query happened where attacker supplied SQLi payload did not execute but got stored in database.
- In some other module of the application, there is a SQL query which takes input by querying the previous database table. Developer now considers the values safe as they are fetched from trusted database. Hence dynamic SQL query is used.

BINGO, now SQL injection will happen and this is example of second orer SQLi.

<!--  -->

<code style="color : darkOrange">Is stored procedures a remeiation for SQLi?</code>

No. SP alone is not a remediation for SQLi. The SQL statemens in SP must be parameterised and not dynamic.

<!--  -->

<code style="color : darkOrange">Any tools you prefer for SQLi?</code>

SQL Map

sqlmap -u <target URL>

sqlmap -r request.txt

<!--  -->

<code style="color : darkOrange">What is Cross Site Scripting (XSS)? Explain the root cause, impact and remediation.</code>

XSS is an attack where attcker supplied malicious script paylaod gets executed in the victim user's browser.

<code style="color : aquamarine">Impact:</code>

1. account takeover via cookie hijacking.
2. redirecting to a malicious attakcer controlled website
3. Defacement of the application

<code style="color : aquamarine">Rootcause:</code>

The application fails to proper input validation/sanitisation

<code style="color : aquamarine">Remediations:</code>

1. Implement proper server side whitelist input validation
2. Implement contextual output encoding

<code style="color : yellowgreen">Note:

Meaning of contextual output encoding:

**HTML Context:** the `<` character can be encoded as `&lt;` and the `>` character can be encoded as `&gt;`. This ensures that the special characters are displayed as text rather than being interpreted as HTML tags.

**JavaScript Context:** the `single quote` character can be encoded as `\'` and the `double quote ` character can be encoded as `\"`. This ensures that the special characters are not interpreted as part of the JavaScript code and can be safely displayed in a web page.

**URL Context:** the `space` character can be encoded as ` %20` and the `ampersand` character can be encoded as `%26`. This ensures that the special characters are not interpreted as part of the URL and can be safely displayed in the address bar of a web browser.
</code>

<!--  -->

<code style="color : darkOrange">What are the various types of XSS?</code>

Broadly there are 4 types of XSS

1.  <code style="color : aquamarine">Reflected XSS:</code>

    In reflected XSS, a malicious payload is typically embedded in a link. When a user clicks on the link the request goes to server then server processes that request and includes the payload in the response which gets executed in the victim user's browser.

2.  <code style="color : aquamarine"> Stored XSS:</code>

    In stored XSS, the payload gets stored in the backend and the attack happens when the server send the payload in the response the request which the user makes.

3.  <code style="color : aquamarine">DOM XSS:</code>

    This type of XSS involves the manipulation of the Document Object Model (DOM) on the client side. The attack occurs when JavaScript code on a page takes user input, incorporates it into the DOM, and then the manipulated DOM is rendered in the user's browser.

    The key point here is that the payload is not sent to the server and back; instead, the malicious code is executed directly in the browser due to improper handling of user input in the client-side JavaScript.

4.  <code style="color : aquamarine">Blind XSS:</code>

    Here the attacker does not have any idea about the sink i.e. where the payload would get executed.

<!--  -->

<code style="color : darkOrange">Self XSS are usually out of scope. Tell us few techniques of exploiting self XSS on other users.</code>

1. Trigger self XSS on victim user by CSRF, if the application is vulnerable to CSRF.
2. Blind XSS"

<!--  -->

<code style="color : darkOrange">Will CSP headers prevent XSS fully?</code>

No. CSP header can be extra layer of security (which can be bypassed) but proper remediation of XSS is input validation & output encoding.

<!--  -->

<code style="color : darkOrange">What is the cookie security attribute for XSS? Will setting the attribute fix XSS?</code>

**httpONLY:** setting httpONLY attribute value TRUE will prevent cookie hijacking via XSS.

<!--  -->

<code style="color : darkOrange">What is HTML injection or HTML Content Spoofing attack? Explain the root cause, impact and remediation.</code>

HTML injection is an attack where the attacker's supplied malicious html payload gets rendered in the target application

<code style="color : aquamarine">Impact:</code>

1. The attacker might be able to perform phishing attack using `<form>` tag.
2. The attacker might be able to load any external media using `<img/>`, `<video/>`, `<audio/>`
3. Include any external malicious website in the application using `<iframe/>`

<code style="color : aquamarine">Rootcause:</code>

The Application fails to do proper input validation

<code style="color : aquamarine">Remediations:</code>

1. HTML output encoding
2. whitelist input validation

<!--  -->

<code style="color : darkOrange">What is Text Content Spoofing attack? Explain the root cause, impact and remediation.</code>

Text content spoofing is an attck where attacker supplied text payload gets rendered in the application as a plain text.

<code style="color : aquamarine">Impact:</code>

Attacker can try to trick victim users to perform some actions by instructing them using text messages on error pages. As the impact is very low, severity also becomes low.

<code style="color : aquamarine">Rootcause:</code>

Usually Text content spoofing can be detected on error pages where attacker controlled inputs are added on error messages.

<code style="color : aquamarine">Remediations:</code>

1. HTML output encoding
2. whitelist input validation
3. Never add user supplied values on error messages, instead use custom error messages.

<!--  -->

<code style="color : darkOrange">What is XML Injection? Explain the root cause, impact and remediation.</code>

XML injection is an attack where attacker's supplied malicious XML paylaod gets added to the server-side XML document in an unsafe way.

<code style="color : aquamarine">Impact:</code>

The impact can vary depending on where XML is used. The attacker might be able to perform authorization bypass, cann temper with the application's logic, or might be able to find sensitive information

<code style="color : aquamarine">Rootcause:</code>

The application fails to properly validate the user input

<code style="color : aquamarine">Remediations:</code>

1. whitelist input validation

<!--  -->

<code style="color : darkOrange">What is Xpath Injection? Explain the root cause, impact and remediation.</code>

<code style="color : yellowgreen">Note: Xpath is a query lamguage which is used to identity elements and attributes in an XML document</code>

Xpath injection is pretty similar to SQL injection

<code style="color : aquamarine">Impact:</code>

- Exploiting this vulnerability, an attacker can find out the structure of XML data, can access data from restricted files.
- Attacker may even be able to perform privilege escalation on the application if XML based role management is used by the application.

<code style="color : aquamarine">Rootcause:</code>

1. Application fails to properly validate user given input
2. Application constructs dynamic SQL queries using the user given input

<code style="color : aquamarine">Remediations:</code>

1. white-list input validation
2. user parameterised SQL queries

<!--  -->

<code style="color : darkOrange">What is XXE? Explain the root cause, impact and remediation.</code>

XXE in possible when the external entity expansion is enbaled by XML parser. The attacker might be able to insert a XML input which containes reference to an external entity which will force the parser to read that and give the result in the response

<code style="color : yellowgreen">Note: Here by <b>external entity</b> we mean some eternal resource, file or webpage</code>

<code style="color : aquamarine">Impact:</code>

1. Port scanning
2. SSRF
3. sensitive data exposure
4. Denial of service

<code style="color : aquamarine">Rootcause:</code>

1. external entity expansion is enbaled by XML parser

<code style="color : aquamarine">Remediations:</code>

• Disable XML external entity and DTD processing in all XML parsers in the application.
• Perform schema validation

<!--  -->

<code style="color : darkOrange">What is LDAP Injection? Explain the root cause, impact and remediation.</code>

<code style="color : yellowgreen">Note: LDAP is a protocol used to access and manage directory informations. A directory is a database that stores information about users, groups, and other resources</code>

LDAP injection is similar to SQL injection

<code style="color : aquamarine">Impact:</code>

1. Attacker might get access to sensitive information
2. Attacker might be able to privilage bypass
3. Attacker might be able to perform

<code style="color : aquamarine">Rootcause:</code>

1. Constructing dynamic queries.
2. Failing to perform proper input validation

<code style="color : aquamarine">Remediations:</code>

• Perform whitelist validation for all user inputs.

• Use parameterised LDAP queries.

<!--  -->

<code style="color : darkOrange">What is Command Injection? Explain the root cause, impact and remediation.</code>

<code style="color : yellowgreen">Command injection attacks happen when an application uses user supplied data to a system shell.In this attack, the attacker-supplied OS commands are usually executed with the privileges of the vulnerable application.</code>

<code style="color : aquamarine">Impact:</code>

Execution of arbitrary commands on the host operating system.

<code style="color : aquamarine">Remediations:</code>

Perform whitelist validation for all user inputs.

<!--  -->

<code style="color : darkOrange">What is Code Injection or Remote Code Execution? Explain the root cause, impact and remediation.</code>

<code style="color : yellowgreen">it is a type of vulnerability that allows an attacker to inject server-side code into an application and have it execute. For example, injecting PHP, Python or server-side JavaScript into eval()..</code>

<code style="color : aquamarine">Impact:</code>

RCE is equivalent to a full compromise of the affected system or application, and can result in serious consequences such as data loss, service disruption, deployment of ransomware or other malware.

<code style="color : aquamarine">Remediations:</code>

- Sanitize inputs - consider zero trust.
- Manage memory securely - buffer overflow protection.
- Implement proper access control.
